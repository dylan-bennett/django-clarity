{% extends base_template|default:"djangoclarity/base.html" %}
{% load django_bootstrap5 clarity_extras %}

{% block title %}
{{ block.super }} | {{ model_verbose_name|title }} Index
{% endblock title %}

{% block content %}
<div class="container py-3">
  <!-- Page header -->
  <div class="d-flex align-items-center justify-content-between w-100 mb-3">
    <h1>{{ model_verbose_name|title }} Index</h1>
    <div class="d-flex align-items-center">
      <!-- Option to put in custom header content ie. an extra link -->
      {% block djangoclarity_index_header_nav_links %}
      <a href="{% url 'admin:index' %}" class="me-2">Back To Admin</a>
      {% endblock djangoclarity_index_header_nav_links %}

      {% bootstrap_button "Create" href=create_url button_class="btn-success" %}
    </div>
  </div>

  <!-- Search form -->
  <div class="mb-3">
    <form method="get" class="d-flex" role="search">
      <input
        type="search"
        name="q"
        value="{{ request.GET.q }}"
        class="form-control me-2"
        placeholder="Search..."
      ></input>
      {% bootstrap_button "Search" button_type="submit" button_class="btn-primary" %}
      {% if request.GET.q %}
        <a href="." class="btn btn-outline-secondary ms-2">Clear</a>
      {% endif %}
    </form>
  </div>

  <table class="table table-striped table-hover">
    <thead>
      <tr>
        {% for field in fields %}
          {% if field == update_url_name %}
          <th>Update</th>
          {% elif field == delete_url_name %}
          <th>Delete</th>
          {% else %}
          <th>{{ field|title }}</th>
          {% endif %}

        {% endfor %}
      </tr>
    </thead>
    <tbody>
      <!-- Any custom items templates in the table -->
      <!-- TODO: FIGURE OUT HOW TO ALLOW FOR CUSTOM TABLE ITEMS -->
      <!-- {% block custom_items %}{% endblock custom_items %} -->

      {% for item in items %}
        <tr>
          {% for field in fields %}
            <td>
              {% if field == update_url_name %}
                <a href="{{ item|get_item:field }}">Update</a>
              {% elif field == delete_url_name %}
                <a href="{{ item|get_item:field }}">Delete</a>
              {% else %}
                {{ item|get_item:field }}
              {% endif %}
            </td>
          {% endfor %}
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- Pagination -->
  <nav aria-label="Page navigation example">
    <ul class="pagination justify-content-center">
      <!-- First page -->
      <li class="page-item{% if not page_obj.has_previous %} disabled{% endif %}">
        <a class="page-link" {% if page_obj.has_previous %}href="?page=1"{% else %}tabindex="-1" aria-disabled="true"{% endif %}>&laquo; first</a>
      </li>

      <!-- Previous page -->
      <li class="page-item{% if not page_obj.has_previous %} disabled{% endif %}">
        <a class="page-link" {% if page_obj.has_previous %}href="?page={{ page_obj.previous_page_number }}"{% else %}tabindex="-1" aria-disabled="true"{% endif %}>previous</a>
      </li>

      <!-- Current page -->
      <li class="page-item">
          <span class="page-link" aria-current="page">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
      </li>

      <!-- Next page -->
      <li class="page-item{% if not page_obj.has_next %} disabled{% endif %}">
        <a class="page-link" {% if page_obj.has_next %}href="?page={{ page_obj.next_page_number }}"{% else %}tabindex="-1" aria-disabled="true"{% endif %}>next</a>
      </li>

      <!-- Last page -->
      <li class="page-item{% if not page_obj.has_next %} disabled{% endif %}">
        <a class="page-link" {% if page_obj.has_next %}href="?page={{ page_obj.paginator.num_pages }}"{% else %}tabindex="-1" aria-disabled="true"{% endif %}>last &raquo;</a>
      </li>
    </ul>
  </nav>
</div>
{% endblock content %}